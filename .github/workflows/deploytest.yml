name: Test deploy on Azure 

on: 
  workflow_dispatch:
env:
  AZURE_WEBAPP_NAME: greatapp    # set this to your application's name
  AZURE_WEBAPP_PACKAGE_PATH: '.' 

jobs:
  deploy:
    runs-on: windows-latest
        # Use the Bash shell regardless whether the GitHub Actions runner is ubuntu-latest, macos-latest, or windows-latest
    defaults:
      run:
        shell: cmd
    steps:
    - name: Azure Login
      uses: azure/login@v1
      with:
       creds: ${{ secrets.AZURE_CREDENTIALS }}
    - name: Azure CLI script
      run: |
        az resource update --name "wbtest110118/config/web" --resource-group "wbtest110118" --resource-type "Microsoft.Web/sites/config" --set "properties.virtualApplications=[{\"virtualPath\":\"\/\",\"physicalPath\":\"site\\wwwroot\",\"virtualDirectories\":null},{\"virtualPath\":\"\/api\",\"physicalPath\":\"site\\wwwroot\\api\",\"virtualDirectories\":null}]"
